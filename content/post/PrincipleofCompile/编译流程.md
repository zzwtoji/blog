---
date: "2025-11-24T16:13:53+08:00"
draft: false
title: "编译流程"
categories:
  - PrincipleofCompile
---

## 词法分析

读取源程序字符流，按语言规则拆分为语法单元（Token）。

- Token
  - 标识符（变量名、函数名）
  - 关键字（if、for）
  - 常量（数字、字符串）
  - 运算符（+、-、\*、/）
  - 分隔符（,、;）

输出：Token 序列

## 语法分析

根据语言的语法规则，将 Token 序列组织成抽象语法树（AST，Abstract Syntax Tree）。

输出：抽象语法树（AST）或语法树

## 语义分析

检查 AST 是否符合语言的语义规则，确保代码逻辑合法。

- 检查内容
  - 类型匹配（整数和字符串不能直接相加、函数参数类型不匹配）
  - 作用域检查（局部变量跨作用域访问）
  - 标识符定义（使用未声明的变量、重复定义）

输出：标注语义信息的 AST

## 中间代码生成

将语义正确的 AST 转换为中间代码（Intermediate Representation，IR），降低目标代码生成的复杂度。

- 常见中间代码形式
  - 三地址码（Three-Address Code）
  - 四元式
  - 逆波兰式

输出：中间代码序列

## 中间代码优化

对中间代码进行优化，提高代码执行效率，减少资源消耗。

- 优化技术
  - 常量折叠（Constant Folding）
  - 死代码消除（Dead Code Elimination）
  - 循环优化（Loop Optimization）

输出：优化后的中间代码

## 目标代码生成

将中间代码转换为目标机器代码（Machine Code）或汇编代码，再通过汇编器转化为机器指令。

- 操作
  - 指令选择
  - 寄存器分配
  - 指令调度

输出：目标机器的汇编代码或二进制目标文件

## 目标代码优化

对生成的目标代码进行进一步优化，提高执行效率和减少内存占用。

- 优化技术
  - 指令重排
  - 寄存器复用

输出：优化后的目标代码
